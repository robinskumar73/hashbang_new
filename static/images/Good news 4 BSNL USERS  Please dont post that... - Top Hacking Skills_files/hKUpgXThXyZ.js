/*!CK:1800209520!*//*1406735568,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["LGxJn"]); }

__d("BroadcastRequestTokenizer.react",["CommentPrelude","DOMQuery","Event","Parent","React","XUITokenizer.react","csx","cx","fbt","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q={};function r(t){p(!!q[t]);return q[t];}var s=k.createClass({displayName:'BroadcastRequestTokenizer',propTypes:{active:k.PropTypes.bool,entries:k.PropTypes.array.isRequired,onSubmitAttempt:k.PropTypes.func,onTokenChange:k.PropTypes.func.isRequired,onTriggerClick:k.PropTypes.func.isRequired,placeHolder:k.PropTypes.string.isRequired,searchSource:k.PropTypes.object.isRequired,sourceID:k.PropTypes.string.isRequired},getInitialState:function(){return {hasQuery:false};},componentDidMount:function(){var t=j.byTag(this.getDOMNode(),'form');this._listener=i.listen(h.find(t,".recommend_link"),'click',this._onTriggerClick);},componentWillMount:function(){p(!q[this.props.sourceID]);q[this.props.sourceID]=this;},componentWillUnmount:function(){this._listener.remove();delete q[this.props.sourceID];},render:function(){var t=(("_3yfm")+(!this.props.active?' '+"_3yfn":''));if(!this.props.active)return (k.createDescriptor(k.DOM.div,{className:t,onClick:this.props.onTriggerClick,onFocus:this.props.onTriggerClick,tabIndex:0},k.createDescriptor(k.DOM.div,{className:"_3yfo"},this.props.placeHolder)));var u=("Search for Recommendations");return (k.createDescriptor(l,{autoHighlight:false,className:t,entries:this.props.entries,onAddEntryAttempt:this._onAddRecommendationEntryAttempt,onInputBlur:this.props.onBlur,onQueryStringChange:this._onQueryStringChange,onRemoveEntryAttempt:this._onRemoveRecommendationEntryAttempt,onEnterWithoutSelection:this._onEnterWithoutSelection,placeholder:u,ref:"tokenizer",searchSource:this.props.searchSource,showEntriesOnFocus:true}));},componentDidUpdate:function(t,u){if(!t.active&&this.props.active)this.refs.tokenizer.focusInput();},_onAddRecommendationEntryAttempt:function(t){var u=this.props.entries;if(!u.some(function(v){return t.getUniqueID()===v.getUniqueID();})){u.push(t);this._onTokenChange(u);}this.setState({hasQuery:false});},_onQueryStringChange:function(event){this.setState({hasQuery:!!event.target.value});},_onRemoveRecommendationEntryAttempt:function(t){var u=this.props.entries.filter(function(v){return t.getUniqueID()!==v.getUniqueID();});this._onTokenChange(u);},_onEnterWithoutSelection:function(event){if(this.props.onSubmitAttempt&&this.props.entries.length>0&&!this.state.hasQuery)this.props.onSubmitAttempt(event);event.preventDefault();},_onTriggerClick:function(){g.expand(this.getDOMNode(),false);this.props.onTriggerClick();},_onTokenChange:function(t){this.props.onTokenChange&&this.props.onTokenChange(t);},_addTokensAndActivateTokenizer:function(t){var u=this.props.entries;t.forEach(function(v){if(!u.some(function(w){return v.getUniqueID()===w.getUniqueID();}))u.push(v);});this._onTokenChange(u);this._onTriggerClick();},statics:{addTokens:function(t,u){r(t)._addTokensAndActivateTokenizer(u);}}});e.exports=s;},null);