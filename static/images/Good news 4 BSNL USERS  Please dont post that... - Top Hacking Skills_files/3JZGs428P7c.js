/*!CK:1959997966!*//*1407121637,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["Wc6QC"]); }

__d("AdsPagerConstants",["keyMirror"],function(a,b,c,d,e,f,g){var h=g({ADD_PAGE:null,PAGE_TRANSITION:null,REQUEST_PAGE:null}),i=g({VIEW_ACTION:null,SERVER_ACTION:null});e.exports={ActionTypes:h,PayloadSources:i};},null);
__d("AdsPagerDispatcher",["AdsPagerConstants","Dispatcher","copyProperties"],function(a,b,c,d,e,f,g,h,i){'use strict';var j=g.PayloadSources;function k(m){return function(n){this.dispatch({payloadSource:m,action:n});};}var l=i(new h(),{handleUpdateFromViewAction:k(j.VIEW_ACTION),handleUpdateFromServerAction:k(j.SERVER_ACTION)});e.exports=l;},null);
__d("AdsRefreshHandler",["AdsMouseStateStore","AdsPagerDispatcher","AdsPagerConstants","Arbiter","Animation","DOM","Event","SubscriptionsHandler","UIPagelet","csx","debounceAcrossTransitions","mergeObjects"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=g.STATES,t=600;function u(v,w,x){"use strict";if(!x.data||!x.pid)return;this.$AdsRefreshHandler0=v;this.$AdsRefreshHandler1=Date.now();this.$AdsRefreshHandler2=w;this.$AdsRefreshHandler3=x;this.$AdsRefreshHandler4=0;this.$AdsRefreshHandler5=false;this.$AdsRefreshHandler6=q(this.reloadAdsIfNeeded.bind(this),this.$AdsRefreshHandler2.delay);this.$AdsRefreshHandler7=new n();this.$AdsRefreshHandler7.addSubscriptions(m.listen(this.$AdsRefreshHandler0,'mouseenter',this.setMouseOver.bind(this,true)),m.listen(this.$AdsRefreshHandler0,'mouseleave',this.setMouseOver.bind(this,false)),g.subscribe('change',this.onMouseStateStoreChange.bind(this)));h.register(this.handlePageDispatch.bind(this));}u.prototype.handlePageDispatch=function(v){"use strict";var w=v.action||{};if(w.actionType===i.ActionTypes.REQUEST_PAGE)this.reloadAds();};u.prototype.setMouseOver=function(v){"use strict";this.$AdsRefreshHandler8=v;};u.prototype.subscribeDefaultEventsForRefresh=function(){"use strict";this.$AdsRefreshHandler7.addSubscriptions(m.listen(window,'scroll',this.$AdsRefreshHandler6),m.listen(window,'resize',this.$AdsRefreshHandler6));return this;};u.prototype.reloadWithDebounce=function(){"use strict";this.$AdsRefreshHandler6();};u.prototype.reloadWithoutDebounce=function(){"use strict";this.reloadAdsIfNeeded();};u.prototype.forceLoadIfEnoughTimePassed=function(v){"use strict";if(Date.now()-this.$AdsRefreshHandler1>v)this.reloadAds();};u.prototype.containsPremium=function(){"use strict";var v=l.scry(this.$AdsRefreshHandler0,"div._4u8");return !!v.filter(function(w){return JSON.parse(w.getAttribute('data-ad')).segment==='premium';}).length;};u.prototype.reloadAdsIfNeeded=function(){"use strict";if(!this.$AdsRefreshHandler0)return;j.inform('AdsRefreshHandler/CheckingReload');if(this.$AdsRefreshHandler2.stateRefresh){this.reloadAdsIfNeededStateBased();return;}if(this.containsPremium()||this.$AdsRefreshHandler8||!this.$AdsRefreshHandler2.interval)return;if(Date.now()-this.$AdsRefreshHandler1>=this.$AdsRefreshHandler2.interval)this.reloadAds();};u.prototype.reloadAdsIfNeededStateBased=function(){"use strict";if(Date.now()-this.$AdsRefreshHandler1<this.$AdsRefreshHandler2.interval)return;if(this.containsPremium())return;if(!this.$AdsRefreshHandler2.interval)return;this.$AdsRefreshHandler5=true;j.inform('AdsRefreshHandler/RefreshScheduled');this.checkScheduledRefresh();};u.prototype.getRefreshScheduled=function(){"use strict";return this.$AdsRefreshHandler5;};u.prototype.onMouseStateStoreChange=function(){"use strict";this.checkScheduledRefresh();};u.prototype.checkScheduledRefresh=function(){"use strict";if(!this.$AdsRefreshHandler5)return;if(this.$AdsRefreshHandler8)return;var v=g.getState(),w=false;switch(v){case s.HOVER:case s.NO_INTENT:w=true;break;default:break;}if(!w)return;this.$AdsRefreshHandler5=false;this.reloadAds();};u.prototype.reloadAds=function(){"use strict";if(!this.$AdsRefreshHandler0)return;this.$AdsRefreshHandler1=Date.now();var v=this.$AdsRefreshHandler3&&this.$AdsRefreshHandler3.data,w=r(v,{refresh_num:++this.$AdsRefreshHandler4});o.loadFromEndpoint('WebEgoPane',this.$AdsRefreshHandler0,{dom_id:l.getID(this.$AdsRefreshHandler0),pid:this.$AdsRefreshHandler3.pid,data:w},{bundle:false,handler:this.onLoadHandler.bind(this)});j.inform('AdsRefreshHandler/AdsLoading');};u.prototype.onLoadHandler=function(){"use strict";j.inform('AdsRefreshHandler/AdsLoaded');if(!this.$AdsRefreshHandler2.fade)return;(new k(this.$AdsRefreshHandler0)).from('opacity',0).to('opacity',1).duration(t).go();};u.prototype.cleanup=function(){"use strict";this.$AdsRefreshHandler0=null;this.$AdsRefreshHandler7.release();this.$AdsRefreshHandler6.reset();};e.exports=u;},null);
__d("TickerReadStateTracking",["Style","clickRefAction"],function(a,b,c,d,e,f,g,h){var i=73,j='ticker_hover',k=[];function l(n){if(!n)return null;var o=JSON.parse(n.getAttribute('data-ft'));if(!o)return null;if(o.mf_story_key)return o.mf_story_key;if(o.fbid)return o.fbid;return null;}function m(n){var o=l(n);if(!o||o in k)return;k[o]=true;var p={evt:i};h(j,n,null,'FORCE',{ft:p});}e.exports.log=m;},null);
__d("TickerController",["Event","Animation","Arbiter","AsyncRequest","AsyncSignal","Bootloader","ChannelConstants","LegacyContextualDialog","CSS","DOM","HTML","JSLogger","Keys","LayerFadeOnHide","LiveTimer","NavigationMessage","Parent","Rect","Run","ScrollableArea","SelectorDeprecated","Style","TickerReadStateTracking","Toggler","UIPagelet","URI","UserActivity","UserAgent","Vector","DOMVector","BanzaiODS","$","clickRefAction","collectDataAttributes","copyProperties","emptyFunction","ge","getElementText","goURI","throttle","userAction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua){var va=1,wa=2,xa=3,ya=4,za=15000,ab=r.create('ticker_controller');function bb(){}oa(bb,{_instances:{},_activeInstance:null,_placeholders:{},_logPositionChange:false,getInstance:function(cb){var db=w.byClass(la(cb),'fbFeedTicker');return db?bb._instances[db.id]:null;},isLoaded:function(cb){var db=bb._placeholders[cb.id];return !db||db.status==xa;},show:function(cb,db){db=db||pa;for(var eb in bb._instances){var fb=qa(eb);if(!fb||fb.parentNode.id==cb.id)continue;bb.hide(fb.parentNode);}bb._doPositionChange(cb);o.show(cb);var gb=bb._placeholders[cb.id];if(gb&&gb.status==va){var hb=(ia.getElementDimensions(cb).y||0)>0,ib=cb.id==='pagelet_rhc_ticker'&&!o.hasClass(cb,'hidden_rhc_ticker');if(hb||ib){bb._fetchTickerForPlaceholder(cb,db);}else i.subscribe('Ticker/resized',function(){if(gb.status==va)bb._fetchTickerForPlaceholder(cb,db);});}else{var jb=p.scry(cb,'.fbFeedTicker')[0],kb=jb&&bb.getInstance(jb);bb._activeInstance=kb;kb&&kb._poll();bb._placeholders[cb.id]={status:ya,callback:db};db();}i.inform('ticker/show',{node:cb,callback:db});},_doPositionChange:function(cb){if(!bb._logPositionChange||o.shown(cb))return;new k('/common/ods_endpoint.php',{k:'ticker.render.switch.'+cb.id}).send();},hide:function(cb){var db=p.scry(cb,'.fbFeedTicker')[0],eb=db&&bb.getInstance(db);eb&&eb.hideActiveStory();o.hide(cb);},hideStoriesByClass:function(cb){for(var db in bb._instances)p.scry(la(db),cb).forEach(o.hide);},hideStory:function(cb){var db=cb&&bb.getInstance(cb);db&&db.hideStory(cb);},replaceStory:function(cb,db){var eb=p.scry(document.body,'div.fbFeedTickerStory'),fb=bb.getInstance(eb[0]),gb=fb._findStoryById(cb);fb.handleRemoveStory();o.hide(gb);p.insertAfter(gb,db);db.setAttribute('data-story-id',gb.getAttribute('id'));var hb=setTimeout(function(){bb.removeMarkup(db,gb);},za);db.setAttribute('data-timeout-token',hb);},removeMarkup:function(cb,db){o.addClass(cb,'removedStoryMarkup');new h(cb).to('height',0).duration(500).ondone(function(){p.remove(cb);}).go();},undoHideStory:function(cb){var db=cb&&bb.getInstance(cb);db&&db.undoHideStory(cb);},insertStoriesAtBottom:function(cb){bb._activeInstance.insertStoriesAtBottom(cb);},_fetchTickerForPlaceholder:function(cb,db){var eb={handler:function(){bb._placeholders[cb.id].status=xa;db();}};ea.loadFromEndpoint('TickerEntStoryPagelet',cb.id,bb._placeholders[cb.id].pageletData,eb);bb._placeholders[cb.id].status=wa;},registerStoryDialog:function(cb,db){i.subscribe('ticker/init',function(){var eb=qa(cb),fb=eb&&bb.getInstance(eb);fb&&fb.registerStoryDialog(eb,db);},i.SUBSCRIBE_ALL);},registerPlaceholder:function(cb,db){var eb=bb._placeholders[cb];bb._placeholders[cb]={status:va,pageletData:db};if(eb&&eb.status==ya){bb.show(la(cb));eb.callback();}}});oa(bb.prototype,{ADS_IDLE_MS:300000,FLYOUT_MAX_HEIGHT:450,FLYOUT_OFFSET_THRESHOLD:20,FLYOUT_COMMENT_OFFSET:15,FLYOUT_VIEWPORT_PADDING:75,FLYOUT_TARGET_HEIGHT_OFFSET:25,DEFAULT_LOOK_BEHIND:10,init:function(cb,db,eb){bb._instances[cb.id]=this;bb._activeInstance=this;this._root=cb;this._content=p.find(cb,'.ticker_stream');this._stories=p.find(this._root,'.tickerActivityStories');this._scrollableArea=db;this._container=p.find(cb,'div.uiScrollableAreaWrap');this._newestStory={};this._storyIDs=[];this._objectIDs=[];this._fetchedStories={};this._fetchedStoriesDialog={};this._storyDialogResources={};this._removedStoryIDs=[];this._storiesToRemove=[];var fb=Date.now();this._initTime=fb;this._lastUpdate=fb;this._lastPull=fb;this._lastInsert=fb;this._lastCustomStory=0;this._pollOnly=false;this._needNonCustomStoryNum=0;this._doCustomUpdate=true;this._autoloadStoryIndex=1;this._scrollTopThreshold=100;this._scrollTopPrompt=p.find(this._root,'.scrollTopPrompt');this._scrollTopPromptVisible=false;this._maxStoriesToKeep=50;this._minStoriesToKeep=25;this._tickerInSidebarMode=!!w.byClass(this._root,'fbChatSidebar');this._loadStoriesWithActions();ma('ticker_flyout');ma('ticker_flyout_prefetch');ma('ticker_flyout_loadtime');ma('ticker_stream');this._ua={flyout:ua('ticker').uai('flyout','flyout',false),flyout_prefetch:ua('ticker').uai('flyout_prefetch','flyout_prefetch',false),flyout_loadtime:ua('ticker').uai('ticker_flyout_loadtime','flyout_loadtime',false),stream:ua('ticker').uai('ticker_stream','stream',false)};this._uaCurStoryIDFetch=null;this._uaCurStoryIDPrefetch=null;var gb=p.create('div',{className:'storyQueue hidden_elem'});this._storyQueue=gb;p.appendContent(this._root,gb);this._lastKStories={head:null,tail:null,count:0,actors:{},apps:{},stories:{}};this._dedupeKeys={};this._initObjectIDs();this._initConfig(eb);this._resetMorePager();this._initListeners();this._initSubscriptions(eb);i.inform('ticker/init',this,i.BEHAVIOR_PERSISTENT);this._poll();},_lastKStoriesInsert:function(cb){this._lastKStories.stories[cb.getAttribute("data-story-key")]=true;var db={story:cb,next:null};if(this._lastKStories.head)this._lastKStories.head.next=db;this._lastKStories.head=db;this._lastKStories.count++;if(!this._lastKStories.tail)this._lastKStories.tail=this._lastKStories.head;var eb=cb.getAttribute("data-actor");if(!this._lastKStories.actors[eb])this._lastKStories.actors[eb]=0;this._lastKStories.actors[eb]++;var fb=cb.getAttribute("data-app");if(fb){if(!this._lastKStories.apps[fb])this._lastKStories.apps[fb]=0;this._lastKStories.apps[fb]++;}if(this._lastKStories.count>this.DEFAULT_LOOK_BEHIND){while(this._lastKStories.tail&&!this._lastKStoriesRemove(this._lastKStories.tail.story))this._lastKStories.tail=this._lastKStories.tail.next;if(!this._lastKStories.tail)this._lastKStories.head=null;}},_lastKStoriesRemove:function(cb){var db=cb.getAttribute("data-story-key"),eb=cb.getAttribute("data-actor"),fb=cb.getAttribute("data-app");if(this._lastKStories.stories[db]){delete this._lastKStories.stories[db];this._lastKStories.actors[eb]--;if(fb)this._lastKStories.apps[fb]--;this._lastKStories.count--;return true;}else return false;},_loadStoriesWithActions:function(){var cb=qa('rightCol');if(!cb)return;this._toggleWrapper=p.scry(cb,'.tickerToggleWrapper')[0];if(this._toggleWrapper){var db=p.scry(this._stories,'.tickerStoryWithButton');this._storiesWithActions={};for(var eb=0;eb<db.length;eb++){var fb=db[eb];this._storiesWithActions[fb.getAttribute('data-story-key')]=fb;}}},_initConfig:function(cb){oa(this,{_newest:cb.newest,_page_newest:cb.newest,_timeout:cb.timeout,_heartbeatTimeout:Math.min(5000,cb.heartbeatTimeout),_maxHeartbeatTimeout:Math.max(30000,cb.maxHeartbeatTimeout),_pullTimeout:Math.max(30000,cb.pullTimeout),_insertTimeout:cb.insertTimeout,_friendCount:cb.friendCount,_maxQueueLength:cb.maxQueueLength,_heartbeatEndpoint:cb.heartbeatEndpoint,_maxCustomQueueLength:cb.maxCustomQueueLength,_customStoryInsertTimeout:Math.max(5000,cb.customStoryInsertTimeout),_nonCustomToCustomStoryRatio:cb.nonCustomToCustomStoryRatio,_minForceUpdateInterval:Math.max(cb.insertTimeout,cb.minForceUpdateInterval),_popupOnHover:cb.popupOnHover,_priorityAppId:cb.priorityAppId,_userIdleTimeout:cb.userIdleTimeout,_firstCustomStoryDelay:cb.firstCustomStoryDelay,_pollOnly:cb.pollOnly,_tickerSource:cb.tickerSource,_logFlyouts:cb.logFlyouts,_userScrollGaurdDelay:cb.userScrollGaurdDelay,_rescheduleScrollToTopDelay:cb.rescheduleScrollToTopDelay,_aggressiveRegulator:cb.aggressiveRegulator});this._queueCustomStories(cb.customStories);},_initListeners:function(){this._listeners=g.listen(this._root,{click:this._handleClick.bind(this),keydown:this._handleKeydown.bind(this),mouseout:this._handleMouseout.bind(this),mouseover:this._handleMouseover.bind(this),mousedown:this._tickerDeClicker.bind(this),mouseup:this._handleMouseup.bind(this)});this._listeners.scroll=g.listen(this._container,'scroll',this._handleScroll.bind(this));setTimeout(this._initInfiniteScrollListener.bind(this),0);},_initSubscriptions:function(cb){y.onLeave(this._cleanup.bind(this));this._subscriptions=[i.subscribe(v.NAVIGATION_BEGIN,this._onNavHandler.bind(this)),i.subscribe('composer/publish',this._handleComposerPublish.bind(this)),i.subscribe('Ticker/storiesInserted',this._handleStoriesInserted.bind(this)),i.subscribe('Ticker/fixed',this._setFixed.bind(this,true)),i.subscribe('Ticker/unfixed',this._setFixed.bind(this,false)),i.subscribe('Ticker/resized',this._checkInfiniteScroll.bind(this)),i.subscribe('ufi/comment',this._scrollDialogToBottom.bind(this)),i.subscribe('Ticker/chatOpened',this._handleChatOpened.bind(this))];if(!cb.pollOnly)this._subscriptions.push(i.subscribe(m.getArbiterType('ticker_update'),this._handleTickerPush.bind(this)));if(cb.pushChannel&&!cb.pollOnly)this.setPushChannel(cb.pushChannel);},_handleClick:function(event){if(!(event.button===1||event.altKey||event.ctrlKey||event.metaKey))event.prevent();var cb=event.getTarget();if(this._getButtonFromNode(cb)){this._logUserAction(cb,'click',event);this._handleActionButton(event);return;}var db=this._getStoryFromNode(cb),eb=w.byClass(cb,'tickerStoryAllowClick');if(!db||db==this._selectedStory||eb)return;if(this._storyIsHidden(db))return;if(db==this._activeStory&&!this._selectedStory)this._selecting=true;this._logUserEvent('flyout','click');this._logUserEvent('flyout_loadtime','open');if(this._storyCanOpenExternally(db)){var fb=db.getAttribute('data-href');if(fb&&!cb.getAttribute('href')){var gb={href:fb},hb=na(cb,['ft','gt']);ma('click',gb,event,'FORCE',hb);ua('ticker',gb,event).uai('click');}else this._logUserAction(cb,'click',event);this._openStoryExternally(db,event);return;}this._logUserAction(cb,'flyout',event);this._activateStory(db,'click');this._selectStory(db);},_handleMouseover:function(event){this._setLocked(true);var cb=event.getTarget(),db=this._getOpenableStory(cb);if(!db){var eb=w.byClass(cb,"_5wvy");if(eb){clearTimeout(parseInt(eb.getAttribute('data-timeout-token'),10));var fb=setTimeout(function(){bb.removeMarkup(eb,db);},za);eb.setAttribute('data-timeout-token',fb);}return;}event.kill();if(this._popupOnHover){if(!(db.id in this._fetchedStories)){this._logUserEvent('flyout_prefetch','prefetch_on_hover');this._uaCurStoryIDPrefetch=db.id;}this._fetchStory(db);}if(this._selectedStory)return;if(this._popupOnHover){this._clearHoverTimeouts();var gb=this._storyCanOpenExternally(db)?500:1000,hb=this._activeStory?75:gb;this._hoverShowTimeout=this._setTimeout(function(){this._logUserEvent('flyout','hover',hb);this._logUserEvent('flyout_loadtime','open');this._activateStory(db,'hover');this._logUserAction(cb,'flyout',event);}.bind(this),hb);}},_handleMouseout:function(event){var cb=event.getTarget();this._setLocked(false);if(cb==this._getStoryFromNode(cb)){var db=p.scry(cb.parentNode,'.openToggler');for(var eb=0;eb<db.length;eb++)aa.toggle(db[eb]);}this._clearClickedStory();this._scheduleHide();},_handleKeydown:function(event){this._tickerDeClicker(event);var cb=this._activeStory;if(!cb)return;var db=g.getKeyCode(event);switch(db){case s.UP:case s.DOWN:var eb=this._getInsertedStories(),fb;if(event.getModifiers().any){fb=db===s.UP?0:eb.length-1;}else fb=eb.indexOf(cb)+(db===s.UP?-1:1);cb=eb[fb];break;case s.ESC:this._deactivateStory(true);return;default:return;}event.kill();if(!cb)return;this._activateStory(cb,'keypress');this._selectStory(cb);},_fadeTopmostStoryButton:function(){var cb=0,db=15;if(this._storiesWithActions)for(var eb in this._storiesWithActions){var fb=this._storiesWithActions[eb],gb=p.scry(fb,'.tickerInlineActionButton')[0],hb=p.scry(gb,'.tickerActionIcon')[0],ib=ia.getElementPosition(gb).y-ia.getElementPosition(this._toggleWrapper).y;if(ib<cb){ba.set(gb,'opacity',0);ba.set(hb,'opacity',0);}else if(ib>=cb&&ib<db){var jb=(ib-cb)/(db-cb);ba.set(gb,'opacity',jb);ba.set(hb,'opacity',jb);break;}else{ba.set(gb,'opacity',1);ba.set(hb,'opacity',1);}}},_handleScroll:function(){if(!this._preventScrollDismiss){this._deactivateStory(true);}else this._preventScrollDismiss=false;if(!this._handleScrollThrottled)this._handleScrollThrottled=ta(this._handleScrollInner.bind(this));this._handleScrollThrottled();},_handleScrollInner:function(){this._fadeTopmostStoryButton();this._checkInfiniteScroll();this._setIsUserScrolling();if(!this._scrollLogged){this._scrollLogged=true;var cb=this._stories.childNodes.length,db=this._stories.getAttribute('data-gt'),eb={ticker_scroll:1,number_stories:cb,source:db};ma('scroll',null,null,'FORCE',{gt:eb});ua('ticker').uai('scroll');}},_setIsUserScrolling:function(){clearTimeout(this._userScrollingToken);if(this._isScrolledToTop()){this._userScrolling=false;return;}this._userScrolling=true;this._userScrollingToken=setTimeout(function(){this._userScrolling=false;this._userScrollingToken=null;}.bind(this),this._userScrollGaurdDelay);},_isUserScrolling:function(){return this._userScrolling;},_handleStoriesInserted:function(){this._initInfiniteScrollListener();if(this._scrollableArea instanceof z){this._scrollableArea.adjustGripper();}else ab.error('wrong_scrollable_area',{dump:this});this._logUserEvent('stream','insert');},_handleActionButton:function(event){var cb=event.getTarget(),db=this._getOpenableStory(cb),eb=this._getStoryDialog(db);if(eb)var fb=eb.subscribe('beforehide',function(){eb.unsubscribe(fb);return false;});},_handleScrollToTopClick:function(){this._scrollToTop(this._poll.bind(this));},_scheduleScrollToTop:function(){this._scrollToTopToken&&clearTimeout(this._scrollToTopToken);this._scrollToTopToken=setTimeout(function(){if(this._isLocked()||this._isUserScrolling()){this._scheduleScrollToTop();}else{this._scrollToTopToken=null;this._scrollToTop();}}.bind(this),this._rescheduleScrollToTopDelay);},_scrollToTop:function(cb){new h(this._container).to('scrollTop',0).ease(h.ease.end).ondone(cb).go();},_clearHoverTimeouts:function(){clearTimeout(this._hoverShowTimeout);clearTimeout(this._hoverHideTimeout);},_getAllStories:function(){return p.scry(this._root,'div.fbFeedTickerStory');},_findStoryById:function(cb){var db=p.scry(this._root,'.fbFeedTickerStory'),eb;for(story in db){eb=db[story];if(cb==this._getStoryDialogParams(eb).token)return eb;}return null;},_getInsertedStories:function(){return this._getAllStories().filter(function(cb){return !o.hasClass(cb,'queuedStory')&&!o.hasClass(cb,'customStory');});},_getQueuedStories:function(){return p.scry(this._storyQueue,'.fbFeedTickerStory.queuedStory');},_getQueuedCustomStories:function(){return p.scry(this._storyQueue,'.fbFeedTickerStory.customStory');},_getButtonFromNode:function(cb){return w.byClass(cb,'tickerInlineOverlay');},_getStoryFromNode:function(cb){return w.byClass(cb,'fbFeedTickerStory');},_getActionButtonFromStory:function(cb){return p.scry(cb,'.tickerInlineActionButton')[0];},_getOpenableStory:function(cb){var db=this._getStoryFromNode(cb);return this._storyCanOpenDialog(db)?db:null;},_getStoryDialog:function(cb){return this._fetchedStoriesDialog[cb.id]||n.getInstance(cb);},_getStoryDialogParams:function(cb){var db=cb&&cb.getAttribute('data-flyoutdata')||null;return db&&JSON.parse(db)||null;},_storyCanOpenDialog:function(cb){return !!this._getStoryDialogParams(cb)&&!this._storyIsHidden(cb);},_storyCanOpenExternally:function(cb){return !!cb.getAttribute('data-href')||!this._storyCanOpenDialog(cb);},_storyIsHidden:function(cb){return o.hasClass(cb,'tickerStoryHidden');},hideActiveStory:function(){this._activeStory&&this.hideStory(this._activeStory);},hideStory:function(cb){this._deactivateStory();if(ra(cb)==='')p.remove(cb);o.addClass(cb,'tickerStoryHidden');o.removeClass(cb,'tickerStoryClickable');},undoHideStory:function(cb){o.addClass(cb,'tickerStoryClickable');o.removeClass(cb,'tickerStoryHidden');},insertStoriesAtBottom:function(cb){if(!cb)return;var db=p.create('div');db.appendChild(cb);var eb=p.scry(db,'.fbFeedTickerStory'),fb=p.find(db,'.tickerMorePager'),gb=[];for(var hb=0;hb<eb.length;hb++)if(!this.dedupeStory(eb[hb]))gb.push(eb[hb]);if(gb.length){gb.push(fb);p.replace(p.find(this._root,'.tickerMorePager'),gb);}i.inform('Ticker/storiesInserted');},_scheduleHide:function(){if(this._popupOnHover&&!this._selectedStory){this._clearHoverTimeouts();this._hoverHideTimeout=this._setTimeout(this._deactivateStory.bind(this),100);}},_setScrollTopPromptVisible:function(cb){this._scrollTopPromptVisible=cb;o.conditionShow(this._scrollTopPrompt,cb);if(cb&&!this._listeners.scrollTop){this._listeners.scrollTop=g.listen(this._scrollTopPrompt,{click:this._handleScrollToTopClick.bind(this)});}else if(!cb&&this._listeners.scrollTop){this._listeners.scrollTop.click.remove();this._listeners.scrollTop=null;}},_isUserIdle:function(){return !ga.isActive(this._userIdleTimeout);},_schedulePoll:function(){clearTimeout(this._pollToken);this._pollToken=this._setTimeout(this._poll.bind(this),this._timeout);},_poll:function(){if(!this._isTickerVisible())return;if(this._storiesToRemove.length>0){if(this._isInsertingStory)return this._schedulePoll();var cb=this._storiesToRemove.pop();this.removeStory(cb);}var db=!this._isScrolledToTop()&&this._getQueuedStories().length;this._setScrollTopPromptVisible(db);var eb=Date.now(),fb=eb-this._lastInsert;if(fb<this._insertTimeout||this._isLocked())return this._schedulePoll();var gb=this._getQueuedStories(),hb=this._getQueuedCustomStories(),ib=this._isUserIdle(),jb=gb.length>0,kb=hb.length>0&&!ib&&(eb-this._initTime>this._firstCustomStoryDelay)&&(this._needNonCustomStoryNum===0||(!jb&&(eb-this._lastCustomStory)>this._customStoryInsertTimeout));if(kb){this.insertStory(hb.shift());this._lastCustomStory=eb;this._needNonCustomStoryNum=this._nonCustomToCustomStoryRatio;return this._schedulePoll();}if(jb){var lb=gb.shift();this.insertStory(lb);this._needNonCustomStoryNum--;if(this._needNonCustomStoryNum<0)this._needNonCustomStoryNum=0;return this._schedulePoll();}if(ib)return ga.subscribeOnce(this._poll.bind(this));var mb=hb.length===0&&this._needNonCustomStoryNum===0&&this._nonCustomToCustomStoryRatio>0&&ga.isActive(this.ADS_IDLE_MS)&&((eb-this._lastUpdate)>this._minForceUpdateInterval),nb=false,ob=false;if(this._pollOnly){ob=eb-this._lastUpdate>this._heartbeatTimeout;}else nb=(eb-this._lastPull>this._pullTimeout);var pb=(mb&&this._doCustomUpdate)||nb||ob;if(!pb)return this._schedulePoll();if(mb)this._doCustomUpdate=false;this.update({pull:nb,fullpoll:ob,needcustomstory:mb});},_updatePollOnlyHeartbeatTimeout:function(){if(this._pollOnly&&this._heartbeatTimeout<this._maxHeartbeatTimeout)this._heartbeatTimeout=Math.min(this._heartbeatTimeout+5000,this._maxHeartbeatTimeout);},update:function(cb){this._updatePollOnlyHeartbeatTimeout();if(!this._pollOnly)return this._schedulePoll();var db={newest:(cb.fullpoll||cb.cache_update)?this._newest:this._page_newest,storyids:this._storyIDs,friendcount:this._friendCount,priorityappid:this._priorityAppId,source:this._tickerSource,needcustomstory:this._nonCustomToCustomStoryRatio>0};oa(db,cb);new j().setURI(this._heartbeatEndpoint).setReadOnly(true).setOption('retries',0).setData(db).setHandler(this._handleResponse.bind(this)).setFinallyHandler(this._poll.bind(this)).setAllowCrossPageTransition(true).send();this._lastUpdate=Date.now();if(db.pull)this._lastPull=this._lastUpdate;this._storyIDs=[];},insertStory:function(cb,db,eb){this._lastInsert=Date.now();window.LiveTimer&&u.addTimeStamps(cb);o.removeClass(cb,'queuedStory');o.removeClass(cb,'customStory');if(db!==false){var fb=eb?this._fadeStoryIn:this._flyStoryIn;if(this._isUserScrolling()){var gb=function(){this._container.scrollTop=this._container.scrollTop+this._stories.firstChild.offsetHeight;this._scheduleScrollToTop();}.bind(this);this._fadeStoryIn(cb,gb);}else this._scrollToTop(fb.bind(this,cb));}else p.prependContent(this._stories,cb);if(this._storiesWithActions&&o.hasClass(cb,'tickerStoryWithButton'))this._storiesWithActions[cb.getAttribute('data-story-key')]=cb;this._removeOldStories();},_removeOldStories:function(){var cb=this._getInsertedStories();if(cb.length<=this._maxStoriesToKeep)return;var db=this._minStoriesToKeep,eb=cb.slice(db);eb.forEach(p.remove);if(this._storiesWithActions)for(var fb=0;fb<eb.length;fb++)delete this._storiesWithActions[eb[fb].getAttribute('data-story-key')];this._resetMorePager();},_resetMorePager:function(){var cb=this._getInsertedStories();if(!cb||!cb.length)return;var db=cb[cb.length-1].getAttribute('data-ticker-timestamp'),eb=p.scry(this._root,'.tickerMorePager a')[0];if(!eb||!db)return;var fb=new fa(eb.getAttribute('ajaxify'));fb.addQueryData({oldest:db});eb.setAttribute('ajaxify',fb);},_setLocked:function(cb){this._locked=cb;},_isLocked:function(){return !!(this._locked||this._activeStory);},informAndRemoveStory:function(cb,db,eb){var fb=this._getStoryFromNode(cb),gb=fb.getAttribute('data-story-key');p.setContent(fb,db);o.addClass(fb,'highlightedStory');this._setTimeout(this.removeStory.bind(this,gb),eb||6000);},_getStoryByStoryKey:function(cb){var db=this._getAllStories();for(var eb=0;eb<db.length;eb++){var fb=db[eb];if(fb.getAttribute('data-story-key')==cb)return fb;}return null;},removeStory:function(cb){this._removedStoryIDs[cb]=true;var db=this._getStoryByStoryKey(cb);if(!db)return;if(this._storiesWithActions)delete this._storiesWithActions[cb];if(db==this._activeStory)this._deactivateStory();var eb=this._getStoryDialog(db);eb&&eb.destroy();this._lastKStoriesRemove(db);var fb=db.getAttribute("data-dedupe-key");if(fb)delete this._dedupeKeys[fb];if(o.hasClass(db,'queuedStory')){p.remove(db);return;}this._animateStoryOut(db);},_isScrolledToTop:function(){return this._container.scrollTop<=this._scrollTopThreshold;},_flyStoryIn:function(cb){var db=p.create('div',{style:{marginTop:'-1000px'}},cb);ba.set(db,'opacity',0);p.prependContent(this._stories,db);var eb=ia.getElementDimensions(db).y;ba.set(db,'marginTop','-'+eb+'px');this._isInsertingStory=true;new h(db).to('marginTop',0).ease(h.ease.end).checkpoint(.5).to('opacity',1).ondone(function(){p.replace(db,cb);this._afterInsert(cb);this._isInsertingStory=false;}.bind(this)).go();},_fadeStoryIn:function(cb,db){new h(this._stories).to('opacity',.5).ondone(function(){p.prependContent(this._stories,cb);if(db)db();new h(this._stories).to('opacity',1).ondone(function(){this._afterInsert(cb);}.bind(this)).go();}.bind(this)).go();},_animateStoryOut:function(cb){var db=p.create('div',{style:{overflow:'hidden',position:'relative'}});p.insertBefore(cb,db);p.appendContent(db,cb);new h(db).to('top',20).to('height',0).to('opacity',0).ease(h.ease.end).ondone(function(){p.remove(db);i.inform('Ticker/animateOut');}.bind(this)).go();},_afterInsert:function(cb){i.inform('Ticker/afterInsert');},setPushChannel:function(cb){this._pushSubscription&&this._pushSubscription.unsubscribe();this._pushSubscription=i.subscribe(m.getArbiterType(cb),this._handleTickerPush.bind(this));d(['ChatConfig','ChannelConnection'],function(db,eb){this._channelConnection=eb;this._checkChannelConnection();this._channelConnectionSubscription=this._channelConnection.subscribe([this._channelConnection.CONNECTED,this._channelConnection.RECONNECTING,this._channelConnection.SHUTDOWN,this._channelConnection.MUTE_WARNING,this._channelConnection.UNMUTE_WARNING],this._handleChannelConnection.bind(this));}.bind(this));},_checkChannelConnection:function(){o.conditionClass(this._root,'disconnected',this._channelConnection.disconnected());},setCurrentAppId:function(cb){this._priorityAppId=cb;},_handleTickerPush:function(cb,db){var eb=db.obj;if(eb.delete_id){this._storiesToRemove.push(eb.delete_id);return;}if(eb.fromups)if(eb.do_logging)this._logDarkLaunch(eb);var fb=eb.story_xhp;if(!fb)return;this._newest=eb.story_time;var gb=q(fb).getRootNode();this.queueStory(gb,eb.flyout_js_cmds);if(this._aggressiveRegulator&&eb.actor==this._newestStory.actorID){this.removeStory(this._newestStory.storyKey);new k('/common/ods_endpoint.php',{k:'ticker.aggr.remove'}).send();}this._newestStory={actorID:eb.actor,storyKey:gb.getAttribute('data-story-key')};},_handleComposerPublish:function(cb,db){db.tickerMarkup&&this.insertStory(db.tickerMarkup);},_logDarkLaunch:function(cb){var db={actor:cb.actor,story_time:cb.story_time,key:cb.story_obj_id,dark:1};new j().setURI('/alite/push/log.php').setData({msg:JSON.stringify(db)}).send();},_logRender:function(){if(this._loggedRender)return;var cb=this._tickerInSidebarMode;if(cb||w.byClass(this._content,'home_right_column')){new k('/ajax/log_ticker_render.php',{sidebar_mode:cb}).send();this._loggedRender=true;}},_isTickerVisible:function(){var cb=(bb._activeInstance==this);cb&&this._logRender();return cb;},_handleResponse:function(cb){var db=cb.getPayload();if(db.newest)this._newest=this._page_newest=db.newest;if(db.content)if(db.content instanceof Array){for(var eb=0;eb<db.content.length;eb++)this.queueStoryMarkup(db.content[eb]);}else this.queueStoryMarkup(db.content);if(db.custom_stories&&db.custom_stories.length){this._queueCustomStories(db.custom_stories);this._doCustomUpdate=true;}},queueStoryMarkup:function(cb){var db=q(cb).getRootNode();this.queueStory(db);},dedupeStory:function(cb){var db=cb.getAttribute('data-story-key'),eb=db&&(!!this._objectIDs[db]||!!this._removedStoryIDs[db]);eb=eb||!!this._lastKStories.actors[cb.getAttribute('data-actor')]||!!this._lastKStories.apps[cb.getAttribute('data-app')];var fb=cb.getAttribute('data-dedupe-key');eb=eb||fb&&this._dedupeKeys[fb];if(cb.getAttribute('data-force-push'))eb=false;db&&(this._objectIDs[db]=true);return eb;},queueStory:function(cb,db){if(this.dedupeStory(cb))return;this._lastKStoriesInsert(cb);var eb=cb.getAttribute("data-dedupe-key");if(eb)this._dedupeKeys[eb]=true;o.addClass(cb,'queuedStory');p.appendContent(this._storyQueue,cb);var fb=db&&db.length;if(fb)db.forEach(function(hb){new Function(hb).apply();});cb.setAttribute('id',cb.id+'_'+this._root.id);var gb=this._getQueuedStories();gb.slice(0,-this._maxQueueLength).forEach(p.remove);if(fb)this._fetchedStories[cb.id]=true;},_queueCustomStories:function(cb){while(cb.length){var db=cb.shift();db=q(db).getRootNode();if(this.dedupeStory(db))continue;o.addClass(db,'customStory');p.appendContent(this._storyQueue,db);}var eb=this._getQueuedCustomStories();eb.slice(0,-this._maxQueueLength).forEach(p.remove);},_cleanup:function(){bb._placeholders.pagelet_rhc_ticker=null;if(!w.byClass(this._content,'hasRightCol'))return;this._objectIDs=[];this._subscriptions.forEach(i.unsubscribe);this._channelConnectionSubscription&&this._channelConnection.unsubscribe(this._channelConnectionSubscription);this._pushSubscription&&this._pushSubscription.unsubscribe();for(var cb in this._listeners)this._listeners[cb]&&this._listeners[cb].remove();clearTimeout(this._pollToken);this._pollToken=null;this._cleanupInputFocusListener();this._cleanupContentResizeListener();i.inform('Ticker/cleanup');},_onNavHandler:function(cb,db){var eb=db.params.key;if(eb!='lf'&&eb!='h')this._cleanup();},registerStoryDialog:function(cb,db){if(this._uaCurStoryIDFetch==cb.id){this._uaCurStoryIDFetch=null;this._logUserEvent('flyout','fetch_success');}if(this._uaCurStoryIDPrefetch==cb.id){this._uaCurStoryIDPrefetch=null;this._logUserEvent('flyout_prefetch','prefetch_success');}this._fetchedStories[cb.id]=true;this._fetchedStoriesDialog[cb.id]=db;db.setContext(cb);db.subscribe('hide',this._deactivateStory.bind(this,true));db.subscribe('success',this._focusStory.bind(this,cb));db.subscribe('beforehide',function(){if(this._selecting){this._selecting=false;return false;}}.bind(this));if(this._popupOnHover){db.subscribe('mouseenter',this._clearHoverTimeouts.bind(this));db.subscribe('mouseleave',this._scheduleHide.bind(this));db.subscribe('show',function(){setTimeout(this._highlightDialogScrollbar.bind(this,db),0);var eb=g.listen(db.getContent(),'mousedown',function(){this._selectStory(cb);eb.remove();}.bind(this));}.bind(this));}if(cb==this._activeStory){this._logUserEvent('flyout_loadtime','show_fetched');this._logUserEvent('flyout','show');this._openDialog(db);}},_highlightDialogScrollbar:function(cb){var db=p.scry(cb.getContent(),'.uiScrollableArea')[0];db&&z.poke(db);},_openStoryExternally:function(cb,event){var db=cb.getAttribute('data-href');if(!db||db=='#')return;var eb=cb.getAttribute('data-story-rel');switch(eb){case 'theater':this._deactivateAndClearStory();l.loadModules(["PhotoViewer"],function(hb){hb.bootstrap(db,cb);});return;case 'async':this._deactivateAndClearStory();j.bootstrap(db,cb);return;}var fb=cb.getAttribute('data-target'),gb=(event.which!=1||event.getModifiers().any||fb=='_blank');gb?window.open(db,'_blank'):sa(db);},_deactivateAndClearStory:function(){this._clearHoverTimeouts();this._deactivateStory();},_focusStoryWillTriggerScroll:function(cb){var db=this._container,eb=db.clientHeight,fb=cb.offsetHeight,gb=db.scrollTop,hb=gb+eb,ib=cb.offsetTop,jb=ib+fb;return ib<gb||jb>hb;},_focusStory:function(cb){if(this._focusStoryWillTriggerScroll(cb))this._preventScrollDismiss=true;var db=new x(cb),eb=w.byClass(cb,'scrollable'),fb=db.boundWithin(new x(eb)).getPositionVector();db.getPositionVector().sub(fb).scrollElementBy(eb);cb.focus();},_selectStory:function(cb){this._selectedStory=cb;o.addClass(cb,'tickerStorySelected');o.addClass(this._root,'tickerChildSelected');},_activateStory:function(cb,db){this._clearHoverTimeouts();if(cb==this._activeStory||!this._storyCanOpenDialog(cb))return;this._deactivateStory();this._focusStory(cb);this._activeStory=cb;o.addClass(cb,'tickerStoryActive');window.Toggler&&da.hide();if(this._logFlyouts){db=db||'unknown';new k('/ajax/feed/ticker/flyout.php',{src:db}).send();}ca.log(cb);var eb=this._getStoryDialog(cb);if(eb){this._logUserEvent('flyout_loadtime','show_prefetched');this._logUserEvent('flyout','show');if(this._storyDialogResources[cb.id])l.loadResources(this._storyDialogResources[cb.id]);this._openDialog(eb);ka.bumpEntityKey('ticker_stories','flyouts.open');return;}if(!(cb.id in this._fetchedStories)){this._uaCurStoryIDFetch=cb.id;this._logUserEvent('flyout','fetch');}this._fetchStory(cb);},handleRemoveStory:function(){this._deactivateStory(true);},_deactivateStory:function(cb){if(this._activeStory===this._deactivatingStory)return;this._deactivatingStory=this._activeStory;if(this._dialog){if(cb===true){this._dialog.enableBehavior(t);}else this._dialog.disableBehavior(t);this._dialog.hide();this._logUserEvent('flyout','close');}if(this._activeStory){o.removeClass(this._activeStory,'tickerStoryActive');o.removeClass(this._activeStory,'tickerStorySelected');o.removeClass(this._root,'tickerChildSelected');}this._dialog=this._selectedStory=this._activeStory=null;this._cleanupInputFocusListener();this._cleanupContentResizeListener();this._deactivatingStory=null;},_logUserAction:function(cb,db,event){ma(db,cb,event,'FORCE');ua('ticker',cb,event).uai(db);},_logUserEvent:function(cb,event){if(this._ua[cb])this._ua[cb].add_event(event);},_fetchStory:function(cb){clearTimeout(this._fetchToken);var db=[],eb=this._getInsertedStories(),fb=eb.indexOf(cb);[-1,0,1].forEach(function(gb){var hb=eb[fb+gb];hb&&db.push(hb);},this);this._fetchToken=setTimeout(this._fetchStories.bind(this,db),100);},_fetchStories:function(cb){var db=[],eb,fb=function(gb){clearTimeout(eb);cb.forEach(function(hb){o.conditionClass(hb,'tickerStoryFetching',gb);});};cb=cb.filter(function(gb){if(gb.id in this._fetchedStories)return false;this._fetchedStories[gb.id]=true;var hb=this._getStoryDialogParams(gb);if(!hb)return false;hb.uniq_id=gb.getAttribute('id');hb.referrer=this._tickerSource;db.push(hb);return true;},this);if(!db.length)return;eb=this._setTimeout(fb.bind(null,true),500);new j('/ajax/feed/ticker/multi_story').setInitialHandler(this._handleDialogResponse.bind(this,db)).setFinallyHandler(fb.bind(null,false)).setErrorHandler(pa).setData({stories:db}).setAllowCrossPageTransition(this._tickerInSidebarMode).send();},_handleDialogResponse:function(cb,db){if(db&&db.resource_map){var eb=[];for(var fb in db.resource_map){var gb=db.resource_map[fb];if(gb.type==='css'&&!gb.permanent)eb.push(fb);}if(eb.length>0)for(var hb=0;hb<cb.length;hb++)this._storyDialogResources[cb[hb].uniq_id]=eb;}},_tickerDeClicker:function(event){var cb=event.getTarget(),db=w.byTag(cb,'a'),eb=this._getStoryFromNode(cb),fb=this._getButtonFromNode(cb);if(eb&&db&&!fb&&o.hasClass(eb,'tickerStoryClickable')&&!o.hasClass(db,'tickerStoryAllowClick')&&!this._storyIsHidden(eb))db.setAttribute('rel','ignore');var gb=(event.button==2),hb=(event.type==='keydown'),ib=eb&&this._getActionButtonFromStory(eb);if(!gb&&ib&&!hb)this._setClickedStory(eb);},_handleMouseup:function(event){this._clearClickedStory();},_setClickedStory:function(cb){this._clearClickedStory();o.addClass(cb,'tickerStoryClicked');this._clickedStory=cb;},_clearClickedStory:function(){if(this._clickedStory){o.removeClass(this._clickedStory,'tickerStoryClicked');this._clickedStory=null;}},_initInfiniteScrollListener:function(){var cb=this._getInsertedStories();if(this._storiesWithActions)for(var db=0;db<cb.length;db++){var eb=cb[db];if(o.hasClass(eb,'tickerStoryWithButton'))this._storiesWithActions[eb.getAttribute('data-story-key')]=eb;}var fb=Math.max(0,cb.length-this._autoloadStoryIndex);this._infiniteScrollStory=cb[fb];this._checkInfiniteScroll();},_checkInfiniteScroll:function(){if(this._infiniteScrollStory){var cb=ia.getElementPosition(this._infiniteScrollStory).y,db=ia.getElementPosition(this._container).y+ia.getElementDimensions(this._container).y;if(cb<db){var eb=p.scry(this._root,'.tickerMorePager a')[0];if(eb){var fb=w.byClass(eb,'stat_elem')||eb;new j(eb.getAttribute('ajaxify')).setReadOnly(true).setRelativeTo(eb).setStatusElement(fb).setAllowCrossPageTransition(true).send();this._logUserEvent('stream','scroll');}this._infiniteScrollStory=null;this._autoloadStoryIndex=5;}}},_setFixed:function(cb){if(!this._selectedStory)return;var db=this._getStoryDialog(this._selectedStory);if(db){db.setFixed&&db.setFixed(cb);db.updatePosition();}},_setTimeout:function(cb,db){return setTimeout(cb,db,!this._tickerInSidebarMode);},_scrollDialogToBottom:function(){var cb=this._dialog&&this._dialog.getContent(),db=cb&&p.scry(cb,'.uiScrollableAreaWrap')[0],eb=db&&z.getInstance(db);eb&&eb.scrollToBottom();},_openDialog:function(cb){if(!this._tickerInSidebarMode)o.addClass(cb.getRoot(),'tickerStoryOverlayOnTop');var db=ja.getScrollPosition();this._dialog=cb.show();window.scrollTo(db.x,db.y);this._updateDialogPosition();this._writeSwfFrame(cb);setTimeout(this._initCommentFocusListener.bind(this),0);setTimeout(this._initContentResizeListener.bind(this),0);this._stupidIE7VideoResizeHack(cb);},_stupidIE7VideoResizeHack:function(cb){if(ha.ie()===7){var db=p.scry(cb.getContent(),'.uiVideoThumb .img');db.forEach(function(eb){ba.set(eb,'width','');});}},_updateDialogPosition:function(){var cb=this._tickerInSidebarMode||!!w.byClass(this._root,'fixed_elem');this._dialog.setFixed&&this._dialog.setFixed(cb);this._adjustFlyoutContentHeight();this._dialog.updatePosition();},_writeSwfFrame:function(cb){var db=this._dialog&&this._dialog.getContent(),eb=p.scry(db,'.swfObject')[0];if(!eb)return;var fb=eb.getAttribute('data-swfid');if(fb&&window[fb]){var gb=window[fb];gb.write(eb);}},_initCommentFocusListener:function(){var cb=this._dialog&&this._dialog.getContent(),db=cb&&p.scry(cb,'.tickerDialogFooter textarea')[0];if(!db)return;this._listeners.inputFocus=g.listen(db,'focus',this._scrollDialogToBottom.bind(this));},_cleanupInputFocusListener:function(){if(this._listeners.inputFocus){this._listeners.inputFocus.remove();this._listeners.inputFocus=null;}},_initContentResizeListener:function(){var cb=this._dialog&&this._dialog.getContent();if(!cb)return;this._listeners.contentResize=g.listen(cb,'click',function(){setTimeout(this._dialog.updatePosition.bind(this._dialog),0);}.bind(this));},_cleanupContentResizeListener:function(){if(this._listeners.contentResize){this._listeners.contentResize.remove();this._listeners.contentResize=null;}},_adjustFlyoutContentHeight:function(){var cb=this._dialog&&this._dialog.getContent(),db=cb&&p.scry(cb,'.uiScrollableAreaWrap')[0];if(!db)return;var eb=ia.getElementDimensions(db),fb=ia.getElementPosition(db),gb=p.scry(db,'.uiUfi .uiUfiComment'),hb=ia.getViewportDimensions().y-this.FLYOUT_VIEWPORT_PADDING,ib=Math.min(this.FLYOUT_MAX_HEIGHT,hb),jb=ib-this.FLYOUT_TARGET_HEIGHT_OFFSET;for(var kb=0;kb<gb.length;kb++){var lb=gb[kb],mb=ia.getElementPosition(lb),nb=mb.y-fb.y;if(Math.abs(nb-jb)<=this.FLYOUT_OFFSET_THRESHOLD){jb=nb+this.FLYOUT_COMMENT_OFFSET;break;}}if(eb.y>=jb){ba.set(db,'height',jb+'px');ba.set(db,'max-height',null);}else{ba.set(db,'max-height',ib+'px');ba.set(db,'height',null);}},_initObjectIDs:function(){var cb=this._getAllStories();for(var db=cb.length-1;db>=0;db--){var eb=cb[db].getAttribute('data-story-key');if(eb){this._objectIDs[eb]=true;this._lastKStoriesInsert(cb[db]);var fb=cb[db].getAttribute("data-dedupe-key");if(fb)this._dedupeKeys[fb]=true;}}},_handleChatOpened:function(){this._deactivateStory(true);},_handleChannelConnection:function(){this._checkChannelConnection();},getNewest:function(){return this._newest;}});e.exports=bb;},null);
__d("HomeTickerFirstRightColumnController",["$","ge","throttle","AdsRefreshHandler","Arbiter","NavigationMessage","Style","csx","CSS","DOM","Vector","Run","LegacyContextualDialog","TickerController","Event"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=null,w=75,x=50,y=12,z=false,aa,ba,ca,da,ea,fa,ga,ha,ia=x,ja=[],ka=[],la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya;function za(){if(oa)na.appendChild(oa);setTimeout(kb,0);}function ab(){ka=[k.subscribe('ProfileQuestionAnswered',fb),k.subscribe('AdsRefreshHandler/AdsLoaded',za),k.subscribe(l.NAVIGATION_BEGIN,cb),k.subscribe('netego_loaded',kb),k.subscribe('Ticker/storiesInserted',kb),k.subscribe('Megaphone/show',kb)];if(v.enableSidebar){ka.push(k.subscribe('sidebar/hide',lb));ka.push(k.subscribe('sidebar/show',mb));}}function bb(){xa=p.scry(document,'div.fbRemindersContent');sa=p.scry(h('rightCol'),'div.home_right_column')[0];ta=p.find(sa,'div.rightColumnWrapper');na=h('pagelet_ego_pane');u.listen(na,'mouseenter',function(){z=true;});u.listen(na,'mouseleave',function(){z=false;});pa=h('pagelet_rhc_ticker');if(!pa)return false;qa=p.scry(pa,'.ticker_container')[0];ra=p.scry(pa,'.ticker_stream')[0];return qa&&ra;}function cb(ob,pb){if(ya!=null){ya.cleanup();ya=null;}ka.forEach(function(qb){qb.unsubscribe();});ka=[];ja.forEach(function(qb){qb.remove();});ja=[];}function db(){if(ga||!aa)ha=q.getElementPosition(na,'viewport').y-q.getElementPosition(ta,'viewport').y;}function eb(){db();var ob=ia;hb();if(ob!=ia){ga=true;ib();}wa=ua+q.getElementPosition(ma,'viewport').y;var pb=wa,qb=q.getElementPosition(sa,'viewport').y;for(var rb=0;rb<xa.length;rb++){var sb=s.getInstance(xa[rb]);sb.hide();}if(ba||!ra){if(fa!==null){var tb=qb+ha,ub=tb<=pb-fa;if(ga||ub!==aa){ga=false;var vb=pb-fa-ha;jb(ub,vb);}}return;}if(v.hasLitestandClassicCards)pb+=y;var wb=qb<=pb+y;if(wb!==aa)jb(wb,pb);}function fb(ob,pb){oa=pb;ya.forceLoadIfEnoughTimePassed(0);}function gb(){ga=true;db();hb();ib();eb();}function hb(){if(typeof va==='undefined'&&h('pageFooter'))va=q.getElementDimensions(h('pageFooter')).y;var ob=q.getDocumentDimensions().y-(q.getScrollPosition('document').y+q.getViewportDimensions().y);ia=ob>va?x:w;}function ib(){var ob=q.getViewportDimensions().y-ua-ia,pb=q.getElementDimensions(ta).y;if(pb<=ob){fa=0-ha-y;return;}var qb;if(ea){var rb=q.getElementPosition(na).y,sb=ta.children[0].children,tb=pb-y;for(qb=0;qb<sb.length-1;qb++){var ub=q.getElementDimensions(sb[qb]).y;tb-=ub;if(tb<=ob){fa=q.getElementPosition(sb[qb]).y+ub-rb;return;}}}var vb=pb-ha;if(vb<=ob){fa=0;}else{var wb=p.scry(na,'div.ego_unit').reverse(),xb=p.scry(na,"div._4u8").length,yb=v.maxFixedAds;if(xb<=v.maxFixedAds)yb=wb.length;var zb=null;for(qb=0;qb<yb;qb++){var ac=wb[qb],bc=q.getElementPosition(ac,'viewport').y-q.getElementPosition(ta,'viewport').y,cc=q.getElementDimensions(ta).y-bc;if(cc>ob){if(qb>0)zb=wb[qb-1];break;}if(qb==yb-1)zb=ac;}if(zb==null){fa=null;}else fa=q.getElementPosition(zb,'viewport').y-q.getElementPosition(na,'viewport').y;}}function jb(ob,pb){aa=ob;pb=pb||wa;var qb=ob?pb+'px':'';m.set(ta,'top',qb);o.conditionClass(ta,'fixed_elem',ob);var rb=p.scry(ta,'div.displayedTickerToggleWrapper')[0];rb&&o.conditionClass(rb,'toggleWrapperWithoutMargin',ob&&!ra);if(ca){var sb=ob?'Ticker/fixed':'Ticker/unfixed';k.inform(sb);}}function kb(){if(!ca||!ra||o.hasClass(document.documentElement,'tinyViewport')){gb();return;}eb();var ob=q.getViewportDimensions().y,pb=61,qb=q.getElementDimensions(ta).y-q.getElementDimensions(qa).y,rb=q.getElementDimensions(ra).y,sb=ob-qb-w-wa-pb,tb=v.tickerAbsMinHeight||120,ub=v.tickerMinHeight||225;ba=false;if(sb<tb){ba=true;jb(false);sb=tb;}else if(sb<ub)if(sb>(ub-pb)){sb=ub;}else sb+=pb;var vb=Math.min(sb,rb,v.tickerMaxHeight||425);m.set(qa,'height',vb+'px');}function lb(){ca=true;bb();var ob=function(){if(bb()){ba=false;eb();kb();}};pa&&t.show(pa,ob);}function mb(){ca=false;bb();gb();pa&&t.hide(pa);}var nb={init:function(ob,pb){v=ob;la=g('contentCol');ma=p.find(document,"div._4f7n");da=0;ea=v.areAllSectionsFixable;ja.push(u.listen(window,'resize',i(kb)));ua=q.getElementDimensions(ma).y;bb();ya=new j(na,v.adsRefreshConfig,pb).subscribeDefaultEventsForRefresh();if(v._adsRefreshConfigDebug)window.refreshHandler=ya;ab();r.onLeave(cb);ja.push(u.listen(window,'scroll',i(eb)));if(!o.hasClass(document.documentElement,'sidebarMode')){lb();}else if(v.enableSidebar)mb();za();}};e.exports=nb;},null);
__d("TickerRightHideController",["CSS","DOM","ge"],function(a,b,c,d,e,f,g,h,i){function j(){}j._markAsClosedHelper=function(k){var l=i('pagelet_reminders');if(l){var m=h.scry(l,'div.tickerToggleWrapper')[0];if(m)g.conditionClass(m,'displayedTickerToggleWrapper',k);}var n=i('pagelet_moments');if(n){var o=h.scry(n,'div.tickerToggleWrapper')[0];if(o)g.conditionClass(o,'displayedTickerToggleWrapper',k);}var p=i('pagelet_rhc_ticker');if(p){var q=h.scry(p,'div.tickerToggleWrapper')[0];if(q)g.conditionClass(q,"displayedTickerToggleWrapper",!k);g.conditionClass(p,"hidden_rhc_ticker",k);}};j.markAsClosed=function(){j._markAsClosedHelper(true);};j.markAsUnclosed=function(){j._markAsClosedHelper(false);};e.exports=j;},null);
__d("legacy:TickerRightHideController",["TickerRightHideController"],function(a,b,c,d){a.TickerRightHideController=b('TickerRightHideController');},3);
__d("legacy:TickerController",["TickerController"],function(a,b,c,d){a.TickerController=b('TickerController');},3);
__d("AsyncLayout",["AjaxPipeRequest","Arbiter","AsyncRequest","AsyncResponse","CSS","DOM","HTML","NavigationMessage","PageTransitions","URI","$","emptyFunction","ge","goURI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){function u(v){"use strict";this.canvasID=v;if(s('rightCol'))this.auxiliaryID='rightCol';if(s('headerArea'))this.headerID='headerArea';if(s('toolbarContainer'))this.toolbarID='toolbarContainer';this.waitingForAux=false;o.registerHandler(this.catchPageTransition.bind(this));this.subscription=h.subscribe(n.NAVIGATION_BEGIN,this.onNavigate.bind(this));}u.prototype.catchPageTransition=function(v){"use strict";this.subscription.unsubscribe();return false;};u.prototype.getCanvasID=function(v){"use strict";return v.sidecol?'contentCol':'contentArea';};u.prototype.onNavigate=function(v,w){"use strict";var x=w.useAjaxPipe;w=w.params;if(w.endpoint){if(this.request){this.request.setFinallyHandler(r);this.request.abort();}if(this.sideRequest)this.sideRequest.abort();if(x){this.request=new g().setURI(w.endpoint).setData(w).setCanvasId(this.getCanvasID(w)).setFinallyHandler(this.finallyHandler.bind(this)).setErrorHandler(this.errorHandler.bind(this)).setFirstResponseCallback(this.firstResponseCallback.bind(this)).send();}else{w.handled=true;this.waitingForAux=w.sidecol;var y=!!w.iframe,z=new i().setOption('useIframeTransport',y).setURI(new p(w.endpoint)).setReadOnly(true).setMethod('GET').setData(w).setHandler(this.onResponse.bind(this)).setErrorHandler(this.errorHandler.bind(this)).setFinallyHandler(this.finallyHandler.bind(this));this.request=z;z.send();}}};u.prototype.onSideResponse=function(v){"use strict";var w=v.getPayload();if(w&&this.auxiliaryID)this.receivedAux(w);};u.prototype.receivedAux=function(v){"use strict";!this.waitingForAux;this.waitingForAux=false;l.setContent(q(this.auxiliaryID),m(v));};u.prototype.onResponse=function(v){"use strict";var w=v.getPayload();if(w.redirect){t(w.redirect);}else{var x=w.html||w;l.setContent(q(this.canvasID),m(x));if(w.side_html&&this.auxiliaryID)this.receivedAux(w.side_html);if(this.headerID&&!w.keep_header){var y=q(this.headerID);l.setContent(y,m(w.header_html||''));k.conditionShow(y,w.header_html);}if(w.toolbar_html&&this.toolbarID)l.setContent(q(this.toolbarID),m(w.toolbar_html));if(w.js)(new Function(w.js))();k.conditionClass('contentCol','hasRightCol',this.auxiliaryID&&!w.noRightSide);var z=s('rightCol');if(z&&w.noRightSide)l.empty(z);}var aa=v.getRequest().getData();h.inform(n.NAVIGATION_COMPLETED,aa.key);};u.prototype.errorHandler=function(v){"use strict";j.verboseErrorHandler(v);h.inform(n.NAVIGATION_FAILED);this.request=null;};u.prototype.firstResponseCallback=function(v){"use strict";window.scrollTo(0,0);h.inform(n.NAVIGATION_FIRST_RESPONSE);};u.prototype.finallyHandler=function(v){"use strict";this.request=null;o.transitionComplete(true);h.inform(n.NAVIGATION_COMPLETED);};e.exports=u;},null);
__d("legacy:adware-scanner",["AdwareScaner"],function(a,b,c,d){a.AdwareScaner=b('AdwareScaner');},3);